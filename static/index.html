<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å°ç£å‹è³‡ AI Chatbotï¼ˆMVPï¼‰</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>âš–ï¸</text></svg>">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC", Arial, sans-serif; 
      display: flex; flex-direction: column; height: 100vh; background: #f5f7fa;
    }
    
    /* Header */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; padding: 1rem 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      display: flex; justify-content: space-between; align-items: center;
    }
    .header h1 { font-size: 1.5rem; font-weight: 600; }
    .header-actions { display: flex; gap: 0.5rem; }
    .btn-sm { 
      background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);
      padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.9rem;
      transition: all 0.2s;
    }
    .btn-sm:hover { background: rgba(255,255,255,0.3); }
    
    /* Chat Container */
    .chat-container {
      flex: 1; display: flex; flex-direction: column; max-width: 900px; 
      width: 100%; margin: 0 auto; padding: 1rem; overflow: hidden;
    }
    
    /* Messages */
    .messages {
      flex: 1; overflow-y: auto; padding: 1rem; display: flex; flex-direction: column; gap: 1rem;
      scroll-behavior: smooth;
    }
    .message { display: flex; gap: 0.75rem; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .message.user { flex-direction: row-reverse; }
    .message .avatar {
      width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center;
      justify-content: center; font-weight: 600; flex-shrink: 0;
    }
    .message.user .avatar { background: #667eea; color: white; }
    .message.bot .avatar { background: #e0e7ff; color: #667eea; }
    
    .message .content {
      max-width: 70%; padding: 0.875rem 1.125rem; border-radius: 12px; line-height: 1.6;
      word-wrap: break-word;
    }
    .message.user .content { 
      background: #667eea; color: white; border-bottom-right-radius: 4px;
    }
    .message.bot .content { 
      background: white; color: #1a202c; border-bottom-left-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .bot-answer { white-space: pre-wrap; }
    
    /* Citations */
    .citations { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #e2e8f0; }
    .citations-header { font-size: 0.85rem; font-weight: 600; color: #4a5568; margin-bottom: 0.5rem; }
    .citation-item {
      font-size: 0.85rem; padding: 0.5rem; background: #f7fafc; border-left: 3px solid #667eea;
      margin-bottom: 0.5rem; border-radius: 4px;
    }
    .citation-header { display: flex; justify-content: space-between; align-items: center; gap: 0.5rem; }
    .citation-item strong { color: #667eea; }
    .validation-badge {
      font-size: 0.7rem; padding: 0.1rem 0.5rem; border-radius: 999px; background: #edf2f7; color: #2d3748;
      border: 1px solid #cbd5e0;
    }
    .validation-badge.ENFORCED_WHITELIST { background: #c6f6d5; color: #22543d; border-color: #9ae6b4; }
    .validation-badge.WARNING { background: #fefcbf; color: #744210; border-color: #fbd38d; }
    .citation-actions { margin-top: 0.5rem; display: flex; gap: 0.5rem; }
    .citation-actions button {
      font-size: 0.75rem; padding: 0.25rem 0.5rem; background: #e0e7ff; color: #667eea;
      border: none; border-radius: 4px; cursor: pointer;
    }
    .citation-actions button.report {
      background: #fed7d7;
      color: #9b2c2c;
    }
    .citation-actions button.report:hover { background: #feb2b2; }
    .citation-actions button:hover { background: #c7d2fe; }
    .validation-banner {
      margin-top: 0.75rem; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.85rem;
      border: 1px solid transparent;
    }
    .validation-banner .title { font-weight: 600; margin-bottom: 0.25rem; }
    .validation-banner.approve { background: #f0fff4; border-color: #c6f6d5; color: #22543d; }
    .validation-banner.warn { background: #fffaf0; border-color: #fbd38d; color: #744210; }
    .validation-banner .validation-list { margin: 0.5rem 0 0; padding-left: 1.25rem; }
    
    /* Metadata */
    .metadata {
      margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px dashed #e2e8f0;
      font-size: 0.8rem; color: #718096;
    }
    
    /* Input Area */
    .input-area {
      background: white; padding: 1rem 1.5rem; box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
      display: flex; gap: 0.75rem; align-items: center;
    }
    .input-wrapper { flex: 1; display: flex; gap: 0.5rem; align-items: center; }
    #query {
      flex: 1; padding: 0.875rem 1rem; border: 1.5px solid #e2e8f0; border-radius: 8px;
      font-size: 0.95rem; resize: none; font-family: inherit; outline: none;
      transition: border-color 0.2s;
    }
    #query:focus { border-color: #667eea; }
    #send {
      padding: 0.875rem 1.5rem; background: #667eea; color: white; border: none;
      border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;
      white-space: nowrap;
    }
    #send:hover { background: #5568d3; transform: translateY(-1px); }
    #send:disabled { background: #cbd5e0; cursor: not-allowed; }
    
    /* Settings Panel */
    .settings {
      background: white; padding: 0.75rem 1rem; margin-bottom: 1rem; border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; gap: 1rem; flex-wrap: wrap;
      align-items: center; font-size: 0.9rem;
    }
    .settings label { display: flex; align-items: center; gap: 0.5rem; cursor: pointer; }
    .settings input[type="checkbox"] { cursor: pointer; }
    .settings input[type="number"] { width: 60px; padding: 0.25rem 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px; }
    
    /* Empty State */
    .empty-state {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      height: 100%; color: #a0aec0; text-align: center; padding: 2rem;
    }
    .empty-state-icon { font-size: 3rem; margin-bottom: 1rem; }
    .empty-state h2 { font-size: 1.25rem; margin-bottom: 0.5rem; color: #4a5568; }
    .empty-state p { font-size: 0.95rem; }
    
    /* Loading */
    .loading { display: flex; gap: 0.25rem; padding: 0.5rem 0; }
    .loading-dot {
      width: 8px; height: 8px; background: #cbd5e0; border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .loading-dot:nth-child(1) { animation-delay: -0.32s; }
    .loading-dot:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ’¼ å°ç£å‹è³‡ AI Chatbot</h1>
    <div class="header-actions">
      <button class="btn-sm" id="new-session">æ–°æœƒè©±</button>
      <button class="btn-sm" id="feedback">æä¾›å›é¥‹</button>
    </div>
  </div>
  
  <div class="chat-container">
    <div class="settings">
      <label><input id="use_llm" type="checkbox" checked /> ä½¿ç”¨ LLM</label>
      <label><input id="use_rerank" type="checkbox" /> ä½¿ç”¨ Rerank</label>
      <label>TopK <input id="top_k" type="number" min="1" max="20" value="5" /></label>
      <label>å‘é‡ <input id="w_vec" type="number" step="0.1" min="0" max="1" value="0.6" /></label>
      <label>è©æ³• <input id="w_lex" type="number" step="0.1" min="0" max="1" value="0.4" /></label>
    </div>
    
    <div class="messages" id="messages">
      <div class="empty-state">
        <div class="empty-state-icon">ğŸ’¬</div>
        <h2>æ­¡è¿ä½¿ç”¨å°ç£å‹è³‡ AI Chatbot</h2>
        <p>è«‹åœ¨ä¸‹æ–¹è¼¸å…¥æ‚¨çš„å‹å‹•æ³•ç›¸é—œå•é¡Œï¼Œä¾‹å¦‚ï¼šã€ŒåŠ ç­è²»å¦‚ä½•è¨ˆç®—ï¼Ÿã€</p>
      </div>
    </div>
  </div>
  
  <div class="input-area">
    <div class="input-wrapper">
      <textarea id="query" rows="1" placeholder="è«‹è¼¸å…¥ä½ çš„å‹å‹•æ³•ç›¸é—œå•é¡Œ..."></textarea>
      <button id="send">é€å‡º</button>
    </div>
  </div>
  
  <script src="/static/ui.js"></script>
</body>
</html>
